# Copyright Â© 2020 TomTom NV. All rights reserved.
#
# This software is the proprietary copyright of TomTom NV and its subsidiaries and may be
# used for internal evaluation purposes or commercial use strictly subject to separate
# license agreement between you and TomTom NV. If you are the licensee, you are only permitted
# to use this software in accordance with the terms of your license agreement. If you are
# not the licensee, you are not authorized to use this software in any manner and should
# immediately return or destroy it.

parameters:
  # Remote branch to check out.
  branch: ''

steps:
  - template: gradle/gradle.yml@devops-templates
    parameters:
      tasks: >-
        portal_check
      displayName: 'Validate Developer Portal content'
      continueOnError: true

  - publish: $(Build.SourcesDirectory)/docs/portal/build/export
    artifact: developer-portal-export
    displayName: Publish Developer Portal export as artifact

  - bash: |
      set -ux
      grep -Rin "indigo" $(Build.SourcesDirectory)/docs/portal/build/export
      if [ $? -ne 0 ]; then
        echo "No usage of IndiGO found."
      else 
        echo "IndiGO found in Portal export."
        exit 1
      fi
    displayName: Check for usage of IndiGO

